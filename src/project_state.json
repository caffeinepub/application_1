{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 87,
  "summary": "Project is a cute Hello Kitty–themed birthday SPA for Mayo (7 Feb) with Roblox section, emotional finale, animated photo collages, romantic background music (play button), and signature “From Avdhesh ❤️”. A new interactive “cake” page is being added featuring a large cake with a lit candle; tapping triggers a Happy Birthday popup and blows out the candle.",
  "architectural_notes": [
    "Frontend is a component-based React SPA rendered from `main.tsx` into `#root`.",
    "Global providers are composed at the root: TanStack Query (`QueryClientProvider`) and an ICP Internet Identity context provider (`InternetIdentityProvider`), plus `next-themes` `ThemeProvider` inside `App`.",
    "Uses TanStack React Query not only for data fetching, but also for lifecycle management of an ICP actor instance (`useActor`) keyed by principal/identity.",
    "UI appears to follow a shadcn/Radix-style component approach (e.g., `Dialog`, `Tabs`, `Badge`, `Card`, `Button`) with Tailwind utility styling.",
    "Tailwind is configured with OKLCH-based design tokens via CSS variables, supports dark mode via `class`, and includes animation/typography/container-query plugins.",
    "Gallery content is currently static and hardcoded in the frontend as an in-memory array of image metadata.",
    "Landing page expanded with additional sections/components (e.g., Roblox/Finale) and a dedicated MusicControl UI component.",
    "Project now includes an explicit client-side storage abstraction (`StorageClient`) for persisting/retrieving app preferences/state.",
    "Media pipeline expanded: generated images are checked into `public/assets/generated`, and build-template scripts exist to resize and prune unused images for optimized builds.",
    "Backend integration advanced: backend canister code and frontend DID/declaration artifacts were updated alongside `useQueries` to support real query hooks rather than a pure placeholder."
  ],
  "known_issues": [
    "Gallery images are hardcoded and reference `/assets/...`; there is no dynamic loading, pagination, or CMS/backend integration.",
    "Two different `index.css` contents are present in the provided file list (potential duplication/overwriting risk depending on actual repo structure).",
    "`DEFAULT_IDENTITY_PROVIDER` uses `process.env.II_URL`; if unset at runtime, login may fail or behave unexpectedly.",
    "`useInternetIdentity` sets `loginStatus` to `idle` after initialization even when a stored identity is loaded; consumers must rely on `identity` rather than `isLoginSuccess` to detect an authenticated session loaded on mount.",
    "User reports they are on a laptop using Caffeine web UI but cannot find any dashboard/export/download option to obtain the project code (possible UI/permissions/entry-point mismatch).",
    "Publishing/domain error observed: domain `mayo-b'day` rejected because domains must be 5–50 chars and contain only letters, numbers, and hyphens (no apostrophes)."
  ],
  "isFixRequest": false,
  "imageRequirements": "## Required Images\n- Large cute birthday cake with a single lit candle, front view, clean pastel style, transparent background (cake-lit.dim_1200x1200.png)\n- Same cake with the candle extinguished (no flame), subtle smoke curl above wick, matching style and framing, transparent background (cake-out.dim_1200x1200.png)\n- Small candle flame icon (separate element), soft glow, transparent background (candle-flame.dim_256x256.png)\n- Small smoke puff/curl icon, light gray, transparent background (candle-smoke.dim_256x256.png)",
  "generatedImages": [
    {
      "filename": "frontend/public/assets/generated/kitty-bow-heart.dim_512x512.png",
      "description": "Generated image asset added to the project (512x512).",
      "targetWidth": 512,
      "targetHeight": 512
    },
    {
      "filename": "frontend/public/assets/generated/pastel-sparkle-bg.dim_1920x1080.png",
      "description": "Generated background image asset added to the project (1920x1080).",
      "targetWidth": 1920,
      "targetHeight": 1080
    }
  ],
  "existing_features": [
    {
      "id": "IF-1",
      "title": "App shell with global providers and page layout",
      "synonyms": [
        "Application layout",
        "Root composition"
      ],
      "description": "Wraps the UI in `ThemeProvider` (dark by default, system enabled), renders `Header`, `Hero`, `Gallery`, `Footer`, and mounts a global `Toaster` for notifications.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "Sticky header with navigation and theme toggle",
      "synonyms": [
        "Top nav",
        "Theme switcher"
      ],
      "description": "Provides a sticky, translucent header containing branding, anchor navigation links, and a light/dark toggle using `next-themes` with mounted-state guard to avoid hydration/theme mismatch.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "Hero section with CTA and smooth scroll to gallery",
      "synonyms": [
        "Landing hero",
        "CTA section"
      ],
      "description": "Displays a gradient/texture hero banner with title and description and a “View Gallery” button that smoothly scrolls to the `#gallery` section.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Tabbed gallery with category filtering",
      "synonyms": [
        "Image gallery",
        "Category tabs"
      ],
      "description": "Renders a responsive grid of images with tabs for All/Characters/Worlds/Social; filters a static image list by category and shows an empty-state message when no images match.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "Image card component with loading skeleton and hover effects",
      "synonyms": [
        "Gallery card",
        "Thumbnail card"
      ],
      "description": "Displays each gallery image inside a card with a category badge, title/description text, a pulse skeleton until image load, lazy loading, and hover transitions (scale and overlay).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Image modal viewer with metadata",
      "synonyms": [
        "Lightbox",
        "Dialog viewer"
      ],
      "description": "Opens a dialog modal when an image is selected, showing the full image, title, description, and a color-coded category badge, with an explicit close button and dialog open state driven by selection.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Footer with attribution and anchor links",
      "synonyms": [
        "Site footer"
      ],
      "description": "Shows copyright, caffeine.ai attribution link, and anchor navigation links.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-8",
      "title": "Tailwind-based design system with OKLCH theme tokens",
      "synonyms": [
        "Theming",
        "CSS variables theme"
      ],
      "description": "Defines light/dark theme palettes using CSS variables (OKLCH), shared radii, and utility animations (e.g., animated gradient), with Tailwind configured for dark mode via class and additional plugins.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-9",
      "title": "Global toast infrastructure",
      "synonyms": [
        "Notifications",
        "Sonner toaster"
      ],
      "description": "Mounts a global `Toaster` component so the app can display toast notifications, although no toasts are triggered in the provided code.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-10",
      "title": "React Query client setup",
      "synonyms": [
        "TanStack Query setup"
      ],
      "description": "Initializes a `QueryClient` and provides it to the app via `QueryClientProvider` as the basis for query caching and async state.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-11",
      "title": "Internet Identity authentication provider",
      "synonyms": [
        "II auth",
        "Auth context"
      ],
      "description": "Implements `InternetIdentityProvider` and `useInternetIdentity` hook to initialize an AuthClient, load stored identity on mount, perform login via Internet Identity, and logout/clear identity, while exposing status flags and errors through React context.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-12",
      "title": "Backend actor creation hook tied to identity",
      "synonyms": [
        "ICP actor hook",
        "Authenticated actor"
      ],
      "description": "Implements `useActor` using React Query to create an anonymous or authenticated backend actor depending on the current identity, keys the cached actor by principal, and invalidates/refetches all non-actor queries when the actor changes.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-14",
      "title": "Additional landing page sections (Roblox + Finale)",
      "synonyms": [
        "RobloxSection",
        "FinaleSection",
        "Extra content sections"
      ],
      "description": "Adds additional content sections to the landing page beyond the original Hero/Gallery/Footer layout, including dedicated Roblox-themed and finale sections to extend the narrative/marketing content.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-15",
      "title": "Music control UI component",
      "synonyms": [
        "Audio controls",
        "MusicControl"
      ],
      "description": "Introduces a music/audio control component to manage playback or user-facing audio toggles/controls within the landing page experience.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-16",
      "title": "Generated asset pipeline and generated images",
      "synonyms": [
        "Image generation outputs",
        "Generated assets"
      ],
      "description": "Adds generated image assets under `frontend/public/assets/generated` and build-template scripts for resizing/pruning images to manage optimized media in the project.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-17",
      "title": "Storage client utility",
      "synonyms": [
        "StorageClient",
        "Client storage abstraction"
      ],
      "description": "Adds a storage utility to centralize access to browser storage (e.g., localStorage/sessionStorage) for app state/preferences.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-18",
      "title": "Backend canister + declarations and query integration (advanced beyond placeholders)",
      "synonyms": [
        "Motoko core",
        "Backend API wiring",
        "Implemented queries"
      ],
      "description": "Updates the Motoko backend canister and regenerates/updates frontend declarations (`backend.did.*`, `backend.ts`, `backend.d.ts`) along with `useQueries.ts` to move beyond empty scaffolding and support actual backend/query usage through the actor/hooks.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-19",
      "title": "Build-template scaffold for ICP React + Motoko projects",
      "synonyms": [
        "Project template",
        "Exportable build template",
        "ICP deploy template"
      ],
      "description": "Adds/updates a `build-template/` directory that mirrors a deployable ICP project layout (backend + frontend canister yamls, env/config, Vite/Tailwind setup, pnpm workspace/lockfiles, and deploy scripts), including scripts to resize/prune images and additional frontend lint rules for ICP/Internet Identity conventions.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-20",
      "title": "Centralized site content configuration for easy editing",
      "synonyms": [
        "siteConfig",
        "Content model",
        "Editable copy"
      ],
      "description": "Introduces a dedicated content/config module (e.g., `frontend/src/content/siteConfig.ts`) to centralize editable strings and section content for the birthday SPA, enabling easier post-build customization without modifying many components directly.",
      "reqIds": [
        "AR-1"
      ],
      "version": 1
    },
    {
      "id": "IF-21",
      "title": "Project export/download workflow documented (GitHub/ICP CLI build-template)",
      "synonyms": [
        "Export instructions",
        "Download code",
        "ICP CLI deploy template"
      ],
      "description": "Adds/updates build-template and documentation/scripts to support exporting the project code for local editing/running (e.g., via GitHub/ZIP and/or ICP CLI using the included `build-template/` scaffold, `deploy.sh`, and README).",
      "reqIds": [
        "AR-2"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-new-top-level-page-section-named-cake-to-the-existing-spa-and-expose-it-in-the-header-footer-navigation-using-the-existing-centralized-configuration-approach-siteconfig-driven-navigation-visibility",
      "title": "Add a new top-level page/section named “Cake” to the existing SPA and expose it in the header/footer navigation using the existing centralized configuration approach (siteConfig-driven navigation + visibility).",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-the-cake-page-ui-show-a-large-cake-illustration-centered-on-the-page-with-a-visibly-lit-candle-by-default-matching-the-app-s-existing-tailwind-theme-light-dark-and-layout-patterns",
      "title": "Implement the Cake page UI: show a large cake illustration centered on the page with a visibly lit candle by default, matching the app’s existing Tailwind theme (light/dark) and layout patterns.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-add-interaction-when-the-user-taps-clicks-the-cake-or-specifically-the-candle-show-a-popup-that-says-happy-b-day-and-visually-extinguish-the-candle-including-a-simple-animation-for-the-transition-e-g-flame-fade-shrink-small-smoke-puff",
      "title": "Add interaction: when the user taps/clicks the cake (or specifically the candle), show a popup that says “Happy B’day!” and visually extinguish the candle, including a simple animation for the transition (e.g., flame fade/shrink + small smoke puff).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-use-the-existing-ui-infrastructure-for-the-popup-prefer-existing-toast-infrastructure-or-an-existing-dialog-pattern-already-in-the-app-without-modifying-any-read-only-ui-component-sources-under-frontend-src-components-ui",
      "title": "Use the existing UI infrastructure for the popup (prefer existing toast infrastructure or an existing dialog pattern already in the app) without modifying any read-only UI component sources under frontend/src/components/ui.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-add-the-required-generated-image-assets-for-the-cake-page-under-frontend-public-assets-generated-and-render-them-directly-from-the-frontend-no-backend-involvement",
      "title": "Add the required generated image assets for the Cake page under frontend/public/assets/generated and render them directly from the frontend (no backend involvement).",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-3",
      "summary": "Provide clear publish/deploy guidance from Caffeine (how to go live, choose valid domain, and steps if dashboard/export not visible)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Enable/guide user to edit the generated code (access editor or download/export code from Caffeine)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Add a new page named “cake” with a big cake and lit candle; on tap show “Happy b’day” popup and extinguish the candle (with animation).",
      "reqIds": [],
      "status": "in_progress"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Virtual Worlds",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}